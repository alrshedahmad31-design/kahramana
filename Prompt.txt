// DELETE: app/layout.tsx
// DELETE: app/page.tsx



// File: app/[locale]/layout.tsx
import type { Metadata } from "next";
import Script from "next/script";
import { notFound } from "next/navigation";
import { NextIntlClientProvider } from "next-intl";
import { getMessages } from "next-intl/server";
import { GoogleAnalytics, GoogleTagManager } from "@next/third-parties/google";

import { routing } from "@/i18n/routing";
import Header from "@/components/layout/Header";
import Footer from "@/components/layout/Footer";
import BottomNav from "@/components/layout/BottomNav";
import "@/app/globals.css";

const BASE = "https://kahramanat.com";

export async function generateMetadata({
  params,
}: {
  params: { locale: string };
}): Promise<Metadata> {
  const { locale } = params;
  const isAr = locale === "ar";

  const title = isAr
    ? "كهرمانة بغداد | Kahramana Baghdad"
    : "Kahramana Baghdad | كهرمانة بغداد";

  const desc = isAr
    ? "مطعم عراقي أصيل في البحرين — نكهات بغداد الحقيقية من كبة وبرياني وأكلات تراثية."
    : "Authentic Iraqi restaurant in Bahrain — the true flavors of Baghdad: kubba, biryani & heritage cuisine.";

  return {
    metadataBase: new URL(BASE),
    title: {
      default: title,
      template: isAr ? "%s | كهرمانة بغداد" : "%s | Kahramana Baghdad",
    },
    description: desc,
    robots: { index: true, follow: true },
    manifest: "/assets/brand/site.webmanifest",
    icons: {
      icon: [
        { url: "/assets/brand/favicon.ico" },
        { url: "/assets/brand/favicon.svg", type: "image/svg+xml" },
      ],
      apple: "/assets/brand/apple-touch-icon.png",
    },
    alternates: {
      canonical: `${BASE}/${locale}`,
      languages: {
        ar: `${BASE}/ar`,
        en: `${BASE}/en`,
        "x-default": `${BASE}/ar`,
      },
    },
    openGraph: {
      type: "website",
      siteName: "كهرمانة بغداد | Kahramana Baghdad",
      locale: isAr ? "ar_BH" : "en_BH",
      alternateLocale: isAr ? "en_BH" : "ar_BH",
      title,
      description: desc,
      url: `${BASE}/${locale}`,
      images: [
        {
          url: "/assets/brand/og-image.webp",
          width: 1200,
          height: 630,
          alt: "Kahramana Baghdad",
        },
      ],
    },
    twitter: {
      card: "summary_large_image",
      title,
      description: desc,
      images: ["/assets/brand/og-image.webp"],
    },
  };
}

export function generateStaticParams() {
  return routing.locales.map((locale) => ({ locale }));
}

export default async function LocaleLayout({
  children,
  params,
}: {
  children: React.ReactNode;
  params: { locale: string };
}) {
  const { locale } = params;

  if (!routing.locales.includes(locale as "ar" | "en")) notFound();

  const messages = await getMessages();
  const dir = locale === "ar" ? "rtl" : "ltr";

  const GA_ID = process.env.NEXT_PUBLIC_GA_ID;
  const GTM_ID = process.env.NEXT_PUBLIC_GTM_ID;

  return (
    <html lang={locale} dir={dir} suppressHydrationWarning>
      <head>
        <link
          rel="preload"
          href="/assets/fonts/cairo-arabic-400.woff2"
          as="font"
          type="font/woff2"
          crossOrigin="anonymous"
        />
        <link
          rel="preload"
          href="/assets/fonts/cairo-arabic-600.woff2"
          as="font"
          type="font/woff2"
          crossOrigin="anonymous"
        />
        <link
          rel="preload"
          href="/assets/fonts/cairo-arabic-700.woff2"
          as="font"
          type="font/woff2"
          crossOrigin="anonymous"
        />
        <link
          rel="preload"
          href="/assets/fonts/cairo-arabic-900.woff2"
          as="font"
          type="font/woff2"
          crossOrigin="anonymous"
        />

        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossOrigin="anonymous" />
        <link
          rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,200..700,0..1,-50..200"
        />
      </head>

      <body>
        {GTM_ID ? <GoogleTagManager gtmId={GTM_ID} /> : null}

        <NextIntlClientProvider messages={messages}>
          <Header />

          <main>{children}</main>

          <Footer locale={locale} />
          <BottomNav />
        </NextIntlClientProvider>

        <Script src="/cart.js" strategy="afterInteractive" />

        {GA_ID ? <GoogleAnalytics gaId={GA_ID} /> : null}
      </body>
    </html>
  );
}



// File: public/cart.js
(function () {
  "use strict";

  var STORAGE_KEY = "kahramana_cart_v1";
  var WHATSAPP_NUMBER = "97317131413";

  function safeParse(json, fallback) {
    try {
      var v = JSON.parse(json);
      return v && typeof v === "object" ? v : fallback;
    } catch (_e) {
      return fallback;
    }
  }

  function readCart() {
    if (!window.localStorage) return { items: [], branchId: "riffa-hajiyat" };
    var raw = window.localStorage.getItem(STORAGE_KEY) || "";
    var data = safeParse(raw, { items: [], branchId: "riffa-hajiyat" });
    if (!Array.isArray(data.items)) data.items = [];
    if (!data.branchId) data.branchId = "riffa-hajiyat";
    return data;
  }

  function writeCart(cart) {
    if (!window.localStorage) return;
    window.localStorage.setItem(STORAGE_KEY, JSON.stringify(cart));
  }

  function formatBhd(n) {
    var x = Number(n || 0);
    return x.toFixed(3);
  }

  function getTotals(cart) {
    var qty = 0;
    var total = 0;
    for (var i = 0; i < cart.items.length; i++) {
      var it = cart.items[i];
      qty += Number(it.qty || 0);
      total += Number(it.price || 0) * Number(it.qty || 0);
    }
    return { qty: qty, total: total };
  }

  function emitChange() {
    try {
      window.dispatchEvent(new CustomEvent("kahramana:cart"));
    } catch (_e) {}
  }

  function ensureStyles() {
    if (document.getElementById("kh-cart-style")) return;

    var style = document.createElement("style");
    style.id = "kh-cart-style";
    style.textContent =
      "" +
      ".kh-cart-overlay{position:fixed;inset:0;z-index:9999;display:none}" +
      ".kh-cart-overlay[data-open='1']{display:block}" +
      ".kh-cart-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.72);backdrop-filter:blur(10px)}" +
      ".kh-cart-panel{position:absolute;top:0;bottom:0;width:min(420px,92vw);background:var(--bg-secondary);border:1px solid var(--border-subtle);box-shadow:var(--shadow-3);display:flex;flex-direction:column;overflow:hidden;transform:translateX(110%);transition:transform var(--motion-base) var(--ease-std)}" +
      "html[dir='rtl'] .kh-cart-panel{transform:translateX(-110%)}" +
      ".kh-cart-overlay[data-open='1'] .kh-cart-panel{transform:translateX(0)}" +
      ".kh-cart-header{display:flex;align-items:center;justify-content:space-between;padding:16px;border-bottom:1px solid var(--border-subtle)}" +
      ".kh-cart-title{font-weight:900;color:var(--text-primary);font-size:18px}" +
      ".kh-cart-close{width:48px;height:48px;border-radius:9999px;border:1px solid var(--border-subtle);background:rgba(255,255,255,.04);color:var(--text-on-dark);cursor:pointer}" +
      ".kh-cart-body{padding:12px;overflow:auto;flex:1}" +
      ".kh-cart-row{display:flex;gap:12px;align-items:flex-start;padding:12px;border-radius:24px;background:rgba(197,160,89,.06);border:1px solid var(--border-subtle);margin-bottom:10px}" +
      ".kh-cart-img{width:64px;height:64px;border-radius:16px;object-fit:cover;background:rgba(0,0,0,.2)}" +
      ".kh-cart-name{font-weight:800;color:var(--text-on-dark);font-size:14px;line-height:1.2}" +
      ".kh-cart-meta{color:var(--text-muted);font-size:12px;margin-top:6px}" +
      ".kh-cart-actions{margin-inline-start:auto;display:flex;flex-direction:column;align-items:flex-end;gap:10px}" +
      ".kh-cart-qty{display:flex;align-items:center;gap:8px}" +
      ".kh-cart-btn{width:36px;height:36px;border-radius:14px;border:1px solid var(--border-subtle);background:rgba(255,255,255,.04);color:var(--text-on-dark);cursor:pointer}" +
      ".kh-cart-qtynum{min-width:24px;text-align:center;font-weight:800;color:var(--text-on-dark)}" +
      ".kh-cart-remove{background:transparent;border:none;color:var(--brand-spice);cursor:pointer;font-weight:800;font-size:12px}" +
      ".kh-cart-footer{border-top:1px solid var(--border-subtle);padding:12px;display:flex;flex-direction:column;gap:10px}" +
      ".kh-cart-total{display:flex;align-items:center;justify-content:space-between;color:var(--text-on-dark);font-weight:900}" +
      ".kh-cart-select{height:48px;border-radius:16px;border:1px solid var(--border-subtle);background:rgba(0,0,0,.18);color:var(--text-on-dark);padding:0 12px;outline:none}" +
      ".kh-cart-cta{height:48px;border-radius:18px;border:none;background:var(--brand-gold);color:var(--bg-primary);font-weight:900;cursor:pointer;box-shadow:var(--shadow-gold)}" +
      ".kh-cart-empty{padding:18px;border-radius:24px;border:1px dashed var(--border-subtle);color:var(--text-muted);text-align:center}" +
      ".kh-cart-badge{position:absolute;top:-6px;right:-6px;min-width:18px;height:18px;padding:0 6px;border-radius:9999px;background:var(--brand-gold);color:var(--bg-primary);font-weight:900;font-size:11px;display:inline-flex;align-items:center;justify-content:center;box-shadow:var(--shadow-gold)}" +
      "html[dir='rtl'] .kh-cart-badge{right:auto;left:-6px}";
    document.head.appendChild(style);
  }

  function ensureDom() {
    ensureStyles();

    var existing = document.getElementById("kh-cart-overlay");
    if (existing) return existing;

    var overlay = document.createElement("div");
    overlay.id = "kh-cart-overlay";
    overlay.className = "kh-cart-overlay";
    overlay.setAttribute("data-open", "0");
    overlay.setAttribute("aria-hidden", "true");

    var backdrop = document.createElement("div");
    backdrop.className = "kh-cart-backdrop";
    backdrop.addEventListener("click", closeCart);

    var panel = document.createElement("div");
    panel.className = "kh-cart-panel";

    var header = document.createElement("div");
    header.className = "kh-cart-header";

    var title = document.createElement("div");
    title.className = "kh-cart-title";
    title.textContent = document.documentElement.dir === "rtl" ? "سلة الطلب" : "Cart";

    var closeBtn = document.createElement("button");
    closeBtn.className = "kh-cart-close";
    closeBtn.type = "button";
    closeBtn.setAttribute("aria-label", "Close");
    closeBtn.textContent = "×";
    closeBtn.addEventListener("click", closeCart);

    header.appendChild(title);
    header.appendChild(closeBtn);

    var body = document.createElement("div");
    body.className = "kh-cart-body";
    body.id = "kh-cart-body";

    var footer = document.createElement("div");
    footer.className = "kh-cart-footer";
    footer.id = "kh-cart-footer";

    panel.appendChild(header);
    panel.appendChild(body);
    panel.appendChild(footer);

    overlay.appendChild(backdrop);
    overlay.appendChild(panel);

    document.body.appendChild(overlay);

    document.addEventListener("keydown", function (e) {
      if (e.key === "Escape") closeCart();
    });

    return overlay;
  }

  function findCountTarget(btn) {
    var els = btn.querySelectorAll("*");
    var best = null;

    for (var i = 0; i < els.length; i++) {
      var el = els[i];
      if (el.children && el.children.length) continue;
      var txt = (el.textContent || "").trim();
      if (/^\d+$/.test(txt)) best = el;
    }

    if (best) return best;

    var childNodes = btn.childNodes || [];
    for (var j = childNodes.length - 1; j >= 0; j--) {
      var n = childNodes[j];
      if (n && n.nodeType === 3) {
        var t = (n.nodeValue || "").trim();
        if (/^\d+$/.test(t)) return n;
      }
    }

    return null;
  }

  function syncBadges() {
    var cart = readCart();
    var totals = getTotals(cart);
    var count = totals.qty;

    var btns = document.querySelectorAll(
      'button[aria-label="Shopping Cart"],button[aria-label="حقيبة التسوق"]'
    );

    for (var i = 0; i < btns.length; i++) {
      var btn = btns[i];
      var target = findCountTarget(btn);

      if (target && target.nodeType === 3) {
        target.nodeValue = " " + String(count) + " ";
        continue;
      }

      if (target && target.textContent != null) {
        target.textContent = String(count);
        continue;
      }

      btn.style.position = "relative";
      var badge = btn.querySelector(".kh-cart-badge");
      if (!badge) {
        badge = document.createElement("span");
        badge.className = "kh-cart-badge";
        btn.appendChild(badge);
      }
      badge.textContent = String(count);
      badge.style.display = count > 0 ? "inline-flex" : "none";
    }
  }

  function render() {
    var overlay = ensureDom();
    var cart = readCart();
    var totals = getTotals(cart);

    var body = document.getElementById("kh-cart-body");
    var footer = document.getElementById("kh-cart-footer");
    if (!body || !footer) return;

    body.innerHTML = "";
    footer.innerHTML = "";

    var isRtl = document.documentElement.dir === "rtl";

    if (!cart.items.length) {
      var empty = document.createElement("div");
      empty.className = "kh-cart-empty";
      empty.textContent = isRtl ? "السلة فارغة" : "Your cart is empty";
      body.appendChild(empty);
    } else {
      for (var i = 0; i < cart.items.length; i++) {
        (function (item) {
          var row = document.createElement("div");
          row.className = "kh-cart-row";

          var img = document.createElement("img");
          img.className = "kh-cart-img";
          img.alt = item.name || "";
          img.src = item.image || "/assets/brand/logo.webp";

          var info = document.createElement("div");
          info.style.minWidth = "0";

          var name = document.createElement("div");
          name.className = "kh-cart-name";
          name.textContent = item.name || "";

          var meta = document.createElement("div");
          meta.className = "kh-cart-meta";
          meta.textContent = formatBhd(item.price) + " BHD";

          info.appendChild(name);
          info.appendChild(meta);

          var actions = document.createElement("div");
          actions.className = "kh-cart-actions";

          var qtyWrap = document.createElement("div");
          qtyWrap.className = "kh-cart-qty";

          var minus = document.createElement("button");
          minus.type = "button";
          minus.className = "kh-cart-btn";
          minus.textContent = "−";
          minus.addEventListener("click", function () {
            setQty(item.id, Number(item.qty || 1) - 1);
          });

          var qtyNum = document.createElement("div");
          qtyNum.className = "kh-cart-qtynum";
          qtyNum.textContent = String(item.qty || 1);

          var plus = document.createElement("button");
          plus.type = "button";
          plus.className = "kh-cart-btn";
          plus.textContent = "+";
          plus.addEventListener("click", function () {
            setQty(item.id, Number(item.qty || 1) + 1);
          });

          qtyWrap.appendChild(minus);
          qtyWrap.appendChild(qtyNum);
          qtyWrap.appendChild(plus);

          var remove = document.createElement("button");
          remove.type = "button";
          remove.className = "kh-cart-remove";
          remove.textContent = isRtl ? "حذف" : "Remove";
          remove.addEventListener("click", function () {
            removeItem(item.id);
          });

          actions.appendChild(qtyWrap);
          actions.appendChild(remove);

          row.appendChild(img);
          row.appendChild(info);
          row.appendChild(actions);

          body.appendChild(row);
        })(cart.items[i]);
      }
    }

    var select = document.createElement("select");
    select.className = "kh-cart-select";
    select.value = cart.branchId || "riffa-hajiyat";
    select.addEventListener("change", function () {
      var c = readCart();
      c.branchId = select.value;
      writeCart(c);
      emitChange();
      syncBadges();
    });

    var branches = [
      { id: "riffa-hajiyat", nameAr: "الرفاع (الحجيات)", nameEn: "Riffa (Hajiyat)" },
      { id: "muharraq-galali", nameAr: "المحرق (قلالي)", nameEn: "Muharraq (Galali)" },
    ];

    for (var b = 0; b < branches.length; b++) {
      var opt = document.createElement("option");
      opt.value = branches[b].id;
      opt.textContent = isRtl ? branches[b].nameAr : branches[b].nameEn;
      select.appendChild(opt);
    }

    var totalRow = document.createElement("div");
    totalRow.className = "kh-cart-total";

    var totalLabel = document.createElement("div");
    totalLabel.textContent = isRtl ? "الإجمالي" : "Total";

    var totalValue = document.createElement("div");
    totalValue.textContent = formatBhd(totals.total) + " BHD";

    totalRow.appendChild(totalLabel);
    totalRow.appendChild(totalValue);

    var cta = document.createElement("button");
    cta.type = "button";
    cta.className = "kh-cart-cta";
    cta.disabled = !cart.items.length;
    cta.textContent = isRtl ? "اطلب عبر واتساب" : "Order via WhatsApp";
    cta.addEventListener("click", function () {
      openWhatsAppOrder();
    });

    footer.appendChild(select);
    footer.appendChild(totalRow);
    footer.appendChild(cta);
  }

  function openWhatsAppOrder() {
    var cart = readCart();
    if (!cart.items.length) return;

    var isRtl = document.documentElement.dir === "rtl";

    var branchName = (function () {
      if (cart.branchId === "muharraq-galali") return isRtl ? "المحرق (قلالي)" : "Muharraq (Galali)";
      return isRtl ? "الرفاع (الحجيات)" : "Riffa (Hajiyat)";
    })();

    var lines = [];
    lines.push(isRtl ? "طلب جديد من الموقع" : "New order from website");
    lines.push((isRtl ? "الفرع: " : "Branch: ") + branchName);
    lines.push("");

    var totals = getTotals(cart);

    for (var i = 0; i < cart.items.length; i++) {
      var it = cart.items[i];
      lines.push(
        "• " +
          (it.name || "") +
          " × " +
          String(it.qty || 1) +
          " — " +
          formatBhd(Number(it.price || 0) * Number(it.qty || 0)) +
          " BHD"
      );
    }

    lines.push("");
    lines.push((isRtl ? "الإجمالي: " : "Total: ") + formatBhd(totals.total) + " BHD");

    var text = encodeURIComponent(lines.join("\n"));
    window.open("https://wa.me/" + WHATSAPP_NUMBER + "?text=" + text, "_blank", "noopener,noreferrer");
  }

  function addToCart(id, name, price, image) {
    if (!id) return;

    var cart = readCart();
    var found = null;

    for (var i = 0; i < cart.items.length; i++) {
      if (cart.items[i].id === id) {
        found = cart.items[i];
        break;
      }
    }

    if (found) {
      found.qty = Number(found.qty || 1) + 1;
    } else {
      cart.items.push({
        id: String(id),
        name: String(name || ""),
        price: Number(price || 0),
        image: image ? String(image) : "",
        qty: 1,
      });
    }

    writeCart(cart);
    emitChange();
    syncBadges();
  }

  function removeItem(id) {
    var cart = readCart();
    cart.items = cart.items.filter(function (x) {
      return x.id !== id;
    });
    writeCart(cart);
    emitChange();
    syncBadges();
    render();
  }

  function setQty(id, qty) {
    var q = Number(qty || 0);
    var cart = readCart();

    cart.items = cart.items
      .map(function (x) {
        if (x.id !== id) return x;
        x.qty = q;
        return x;
      })
      .filter(function (x) {
        return Number(x.qty || 0) > 0;
      });

    writeCart(cart);
    emitChange();
    syncBadges();
    render();
  }

  function openCart() {
    var overlay = ensureDom();
    overlay.setAttribute("data-open", "1");
    overlay.setAttribute("aria-hidden", "false");
    document.body.style.overflow = "hidden";
    render();
  }

  function closeCart() {
    var overlay = document.getElementById("kh-cart-overlay");
    if (!overlay) return;
    overlay.setAttribute("data-open", "0");
    overlay.setAttribute("aria-hidden", "true");
    document.body.style.overflow = "";
  }

  window.openCart = openCart;
  window.closeCart = closeCart;
  window.addToCart = addToCart;

  window.addEventListener("kahramana:cart", function () {
    syncBadges();
  });

  window.addEventListener("storage", function (e) {
    if (e && e.key === STORAGE_KEY) syncBadges();
  });

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", syncBadges);
  } else {
    syncBadges();
  }
})();



// File: components/cards/MenuItemCard.tsx
import Image from "next/image";
import { cn } from "@/lib/utils";

interface MenuItem {
  id: string;
  name: { ar: string; en: string };
  description: { ar: string; en: string };
  price: number;
  image: string;
  featured?: boolean;
}

export default function MenuItemCard({
  item,
  locale,
  currency,
  className,
}: {
  item: MenuItem;
  locale: string;
  currency: string;
  className?: string;
}) {
  const name = locale === "ar" ? item.name.ar : item.name.en;
  const description = locale === "ar" ? item.description.ar : item.description.en;

  return (
    <article
      className={cn(
        "group relative overflow-hidden rounded-3xl border bg-[var(--bg-tertiary)]/30 shadow-[var(--shadow-1)] transition-all hover:-translate-y-0.5 hover:border-[var(--brand-gold)]/30",
        className
      )}
      style={{ borderColor: "var(--border-subtle)" }}
    >
      <div className="relative aspect-[16/11] w-full overflow-hidden">
        <Image
          src={`/${item.image}`}
          alt={name}
          fill
          sizes="(max-width: 768px) 100vw, 33vw"
          className="object-cover transition-transform duration-300 group-hover:scale-[1.03]"
          priority={false}
        />

        {item.featured ? (
          <div
            className="absolute top-3 inline-flex items-center rounded-full px-3 py-1 text-[11px] font-extrabold"
            style={{
              background: "var(--bg-gold-badge)",
              color: "var(--text-primary)",
              insetInlineStart: "12px",
              border: "1px solid var(--border-subtle)",
              backdropFilter: "blur(8px)",
            }}
          >
            {locale === "ar" ? "مميز" : "Featured"}
          </div>
        ) : null}
      </div>

      <div className="p-4">
        <h3 className="text-[15px] font-extrabold text-[var(--text-on-dark)] line-clamp-2">{name}</h3>
        <p className="mt-1 text-[13px] text-[var(--text-muted)] line-clamp-2">{description}</p>

        <div className="mt-3 flex items-center justify-between gap-3">
          <div className="font-extrabold text-[var(--text-primary)]">
            {item.price.toFixed(3)} {currency}
          </div>

          <button
            type="button"
            onClick={(e) => {
              e.stopPropagation();
              window.addToCart?.(item.id, name, item.price, `/${item.image}`);
            }}
            className="flex items-center justify-center w-9 h-9 rounded-2xl bg-[var(--brand-gold)] text-[var(--bg-primary)] shadow-[var(--shadow-gold)] active:scale-95 transition-all"
            aria-label={locale === "ar" ? "أضف إلى السلة" : "Add to cart"}
            title={locale === "ar" ? "أضف إلى السلة" : "Add to cart"}
          >
            +
          </button>
        </div>
      </div>
    </article>
  );
}



// File: components/ui/AnimatedModal.tsx
"use client";

import React, { createContext, useContext, useEffect, useMemo, useState } from "react";
import { AnimatePresence, motion } from "framer-motion";
import { X } from "lucide-react";
import { cn } from "@/lib/utils";

type ModalContextValue = {
  open: boolean;
  setOpen: (open: boolean) => void;
};

const ModalContext = createContext<ModalContextValue | null>(null);

export function useModal(): ModalContextValue {
  const ctx = useContext(ModalContext);
  if (!ctx) throw new Error("useModal must be used within a Modal");
  return ctx;
}

export function Modal({ children }: { children: React.ReactNode }) {
  const [open, setOpen] = useState(false);
  const value = useMemo(() => ({ open, setOpen }), [open]);
  return <ModalContext.Provider value={value}>{children}</ModalContext.Provider>;
}

export function ModalTrigger({
  children,
  className,
}: {
  children: React.ReactNode;
  className?: string;
}) {
  const { setOpen } = useModal();
  return (
    <button type="button" onClick={() => setOpen(true)} className={className}>
      {children}
    </button>
  );
}

export function ModalBody({
  children,
  className,
}: {
  children: React.ReactNode;
  className?: string;
}) {
  const { open, setOpen } = useModal();

  useEffect(() => {
    if (!open) return;

    const prev = document.body.style.overflow;
    document.body.style.overflow = "hidden";

    const onKeyDown = (e: KeyboardEvent) => {
      if (e.key === "Escape") setOpen(false);
    };

    document.addEventListener("keydown", onKeyDown);
    return () => {
      document.body.style.overflow = prev;
      document.removeEventListener("keydown", onKeyDown);
    };
  }, [open, setOpen]);

  return (
    <AnimatePresence>
      {open ? (
        <div className="fixed inset-0 z-[100] flex items-center justify-center p-4">
          <motion.button
            type="button"
            aria-label="Close modal"
            onClick={() => setOpen(false)}
            className="absolute inset-0 bg-ebony-black/80 backdrop-blur-md"
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            exit={{ opacity: 0 }}
          />

          <motion.div
            role="dialog"
            aria-modal="true"
            className={cn(
              "relative z-[101] w-full max-w-[640px] overflow-hidden rounded-3xl border border-white/10 bg-[var(--bg-primary)] shadow-[var(--shadow-3)]",
              className
            )}
            initial={{ opacity: 0, y: 16, scale: 0.98 }}
            animate={{ opacity: 1, y: 0, scale: 1 }}
            exit={{ opacity: 0, y: 16, scale: 0.98 }}
            transition={{ duration: 0.2 }}
            onClick={(e) => e.stopPropagation()}
          >
            <button
              type="button"
              onClick={() => setOpen(false)}
              className="absolute right-4 top-4 z-[102] inline-flex h-12 w-12 items-center justify-center rounded-full bg-white/5 text-white/60 transition hover:bg-white/10 hover:text-white"
              aria-label="Close"
            >
              <X className="h-5 w-5" />
            </button>

            {children}
          </motion.div>
        </div>
      ) : null}
    </AnimatePresence>
  );
}

export function ModalContent({ children, className }: { children: React.ReactNode; className?: string }) {
  return <div className={cn("p-6", className)}>{children}</div>;
}

export function ModalFooter({ children, className }: { children: React.ReactNode; className?: string }) {
  return (
    <div className={cn("flex items-center justify-between gap-3 border-t border-white/10 p-4", className)}>
      {children}
    </div>
  );
}



// File: types/window.d.ts
export {};

declare global {
  interface Window {
    openCart?: () => void;
    closeCart?: () => void;
    addToCart?: (id: string, name: string, price: number, image?: string) => void;
  }
}



// File: next-env.d.ts
/// <reference types="next" />
/// <reference types="next/image-types/global" />

// NOTE: This file should not be edited.



// File: tsconfig.json
{
  "compilerOptions": {
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [{ "name": "next" }],
    "paths": { "@/*": ["./*"] }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", "**/*.d.ts", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}